<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>SKU Price Calculator</title>
        
        <!-- Add some CSS styles for spacing -->
        <style>
            body {
                font-family: Arial, sans-serif;
                text-align: center;
                margin: 20px; /* Add margin to the body */
                min-height: 200px;
            }
    
            form {
                max-width: 400px; /* Limit form width for better readability */
                margin: 0 auto; /* Center the form horizontally */
                padding: 20px; /* Add padding to the form */
                border: 1px solid #ccc; /* Add a border for better visibility */
                border-radius: 8px; /* Optional: Add rounded corners */
            }
    
            label {
                display: block;
                margin-bottom: 10px; /* Add space below each label */
            }
    
            input {
                width: 100%;
                padding: 8px;
                margin-bottom: 16px; /* Add space below each input */
                box-sizing: border-box;
            }
    
            button {
                background-color: #4CAF50;
                color: white;
                padding: 10px;
                border: none;
                border-radius: 4px;
                cursor: pointer;
            }
            /* format output table*/
            table {
                border-collapse: collapse;
                width: 100%;
                margin-top: 20px;
            }

            th, td {
                border: 1px solid #ddd;
                padding: 8px;
                text-align: left;
            }

            th {
                background-color: #f2f2f2;
            }
</style>
        </style>
       <script>
        function updateResultsTable(results) {
            var tableBody = document.getElementById('results-table').getElementsByTagName('tbody')[0];
    
            // Clear existing rows
            tableBody.innerHTML = '';
    
            // Populate the table with results
            results.forEach(function(result) {
                var row = tableBody.insertRow();
                var cellTitle = row.insertCell(0);
                var cellLength = row.insertCell(1);
                var cellWidth = row.insertCell(2);
                var cellPrinter = row.insertCell(3);
                var cellSubstrate = row.insertCell(4);
                var cellFrameType = row.insertCell(5);
                var cellPrice = row.insertCell(6);
    
                cellTitle.innerHTML = result.title;
                cellLength.innerHTML = result.length;
                cellWidth.innerHTML = result.width;
                cellPrinter.innerHTML = result.printer;
                cellSubstrate.innerHTML = result.substrate;
                cellFrameType.innerHTML = result.frame_type;
                cellPrice.innerHTML = result.price;
            });
        }
    </script>
    </head>
<body>
    <img src="{{ url_for('static', filename='logo.png') }}" alt="logo" style="max-width: 50%; height: auto; margin-top: 10px;">

    <h1>SKU Price Calculator</h1>
    <form action="/calculate" method="post" onsubmit="return submitForm()">

        <label for="title">Title of Piece:</label>
        <input type="text" name="title" required><br>

        <label for="length">Length:</label>
        <input type="text" name="length" required><br>

        <label for="width">Width:</label>
        <input type="text" name="width" required><br>

        <label for="substrate">Substrate:</label>
        <select name="substrate" id="substrate">
            <option value="canvas">Canvas</option>
            <option value="Epson-paper">Epson Paper</option>
            <option value="Canon-paper">Canon Paper</option>
            <option value="mdf">MDF</option>
        </select> <br>

        <label for="printer">Printer:</label>
        <select name="printer" id="printer">
            <option value="inca-reductive">Inca-Reductive</option>
            <option value="inca-synograph">Inca-Synograph</option>
            <option value="epson">Epson</option>
            <option value="swissQ-synograph">swissQ-Synograph</option>
            <option value="SwissQ-Reductive">SwissQ-Reductive</option>
            <option value="canon">Canon</option>
        </select> <br>

        <label for="frame_type">Frame Type:</label>
        <select name="frame_type" id="frame_type">
            <option value="fps">Gallery Wrap/Mount</option>
            <option value="bfl">Black Float</option>
            <option value="cfl">Champagn Float</option>
            <option value="gfl">Gold Float</option>
            <option value="bgf">Black Gold Float</option>
            <option value="nfl">Natural Float</option>
            <option value="wfl">Walnut Float</option>
            <option value="wcap">Walnut Cap</option>
            <option value="bcap">Black Cap</option>
            <option value="ncap">Natural Cap</option>
            <option value="gcap">Gold Cap</option>
            <option value="gwt">Gallery Wrap W/ Tacks</option>
            <option value="capa">Capital A Antique Gold</option>
            <option value="capb">Capital B Antique Gold</option>
            <option value="capba">Capital B Antique Gold W/ Acrylic</option>
        </select> <br>

        <label for="hardware">Hanging Hardware:</label>
        <select name="hardware" id="hardware">
            <option value="cleat">Cleat</option>
            <option value="wire">Plastic Wire</option>
            <option value="d-rings">D-rings</option>
        </select> <br>

        <label for="margin_percent">Desired Percent Margin:</label>
        <input type="text" name="margin_percent" required><br>

        <label for="royality_percent">Percent Royalty:</label>
        <select name="royality_percent" id="royality_percent">
            <option value="0">0%</option>
            <option value="5">5%</option>
            <option value="10">10%</option>
        </select>

        <label for="is_varn">With Varnish</label>
        <input type="checkbox" name="is_varn" value="on"><br>

        <button type="submit">Calculate</button>
    </form>

    <!--Display the results in a container on the same page____________________________________________________________________________-->
    <div id="results-container">
        <!-- Display results in a table or another suitable format -->
        <table id="results-table">
            <!-- Table headers -->
            <tr>
                <th>Title</th>
                <th>Length</th>
                <th>Width</th>
                <th>Printer</th>
                <th>Substrate</th>
                <th>Frame Type</th>
                <th>Hardware</th>
                <th>is_varn</th>
                <th>margin_percent</th>
                <th>royality_percent</th>
                <th>Price</th>
            </tr>
            <!-- Table body will be populated dynamically using JavaScript -->
        </table>
    </div>
    <script>
        function submitForm() {
            // Get form data
            var formData = {
                title: document.getElementsByName("title")[0].value,
                length: document.getElementsByName("length")[0].value,
                width: document.getElementsByName("width")[0].value,
                substrate: document.getElementsByName("substrate")[0].value,
                printer: document.getElementsByName("printer")[0].value,
                frame_type: document.getElementsByName("frame_type")[0].value,
                is_varn: document.getElementsByName("is_varn").checked[0],
                hardware: document.getElementsByName("hardware")[0].value,
                margin_percent: document.getElementsByName("margin_percent")[0].value,
                royality_percent: document.getElementsByName("royality_percent")[0].value,
            };
    
            // Perform an AJAX request to Flask backend
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "/calculate", true);
            xhr.setRequestHeader("Content-Type", "application/json");
    
            // Handle the response from the server
            xhr.onload = function () {
                if (xhr.status === 200) {
                    // Parse the JSON response
                    var results = JSON.parse(xhr.responseText);
    
                    // Update the results table with the received data
                    updateResultsTable(results);
                } else {
                    console.error("Failed to get results. Status: " + xhr.status);
                }
            };
    
            // Convert form data to JSON and send the request
            xhr.send(JSON.stringify(formData));
    
            // Prevent the default form submission
            return false;
        }
    </script>
    
</body>
</html>
